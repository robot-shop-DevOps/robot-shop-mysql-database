apiVersion: apps/v1

kind: StatefulSet

metadata:
  name: {{ .Values.statefulset.mysqlmaster.name }}

  labels:
{{ .Values.labels | toYaml | indent 4 }}
  annotations:
{{ .Values.statefulset.mysqlslave.annotations | toYaml | indent 4 }}

spec:
  selector:
    matchLabels:
{{ .Values.labels | toYaml | indent 6 }}

  serviceName: {{ .Values.service.mysqlmaster.name }}

  replicas: {{ .Values.statefulset.mysqlmaster.replicas }}

  updateStrategy:
{{ .Values.statefulset.mysqlmaster.updateStrategy | toYaml | indent 4 }}

  template:
    metadata:
      labels:
{{ .Values.labels | toYaml | indent 8 }}

    spec:
      nodeSelector:
{{ .Values.statefulset.mysqlmaster.pod.nodeSelector | toYaml | indent 8 }}

      volumes:
{{ .Values.statefulset.mysqlmaster.pod.volumes | toYaml | indent 8 }}

      containers:
{{ .Values.statefulset.mysqlmaster.pod.containers | toYaml | indent 8 }}

  volumeClaimTemplates:
{{ .Values.statefulset.mysqlmaster.volumeClaimTemplates | toYaml | indent 4 }}